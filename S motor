#include <lpc213x.h>

void clockWise(void);

void antiClockWise(void);

unsigned int coil;

unsigned int i, j, k;

int main() {

 PINSEL0 = 0x00000000; // Configure pins as GPIO

 IO0DIR |= 0x000000F0; // Set P0.4 to P0.7 as output

 IO0CLR = 0x000000F0; // Clear P0.4 to P0.7

 while (1) {

 for (j = 0; j < 4; j++)

 clockWise();

 for (k = 0; k < 65000; k++);

 for (j = 0; j < 4; j++)

 antiClockWise();

 for (k = 0; k < 65000; k++);

 }

 return 0;

}

void clockWise() {

 coil = 0x80; // Initialize coil pattern

 for (i = 0; i < 4; i++) {

 IO0CLR = 0xF0; // Clear P0.4 to P0.7

 IO0SET = ((coil >> i) << 4) & 0xF0; // Set coil pattern

 for (k = 0; k < 12000; k++);

 }

}

void antiClockWise() {

 coil = 0x08; // Initialize coil pattern

 for (i = 0; i < 4; i++) {

 IO0CLR = 0xF0; // Clear P0.4 to P0.7

 IO0SET = ((coil << i) << 4) & 0xF
